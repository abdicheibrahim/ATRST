@{
    ViewData["Title"] = "| Education";
}
<!-- ✅ Main Content -->
<div class="content">
    <h2>Education</h2>

    <!-- ✅ Toast Container for Notifications -->
    <div id="toastContainer" style="position: fixed; top: 20px; right: 20px; z-index: 9999;"></div>

    <div class="row shadow-s g-3 needs-validation p-3 mb-5 mt-3 bg-white border rounded">
        <form id="profileForm">
            <div id="alertContainer"></div>

            <div class="mb-3">
                <label for="name" class="form-label">Name</label>
                <input type="text" class="form-control" id="name" placeholder="Enter your name">
            </div>

            <div class="mb-3">
                <label for="biography" class="form-label">Biography</label>
                <textarea class="form-control" id="biography" rows="3" placeholder="Write your biography"></textarea>
            </div>

            <div class="mb-3">
                <label for="skills" class="form-label">Skills</label>
                <input type="text" class="form-control" id="skills" placeholder="Enter your skills">
            </div>

            <div class="mb-3">
                <label for="keywords" class="form-label">Keywords</label>
                <input type="text" class="form-control" id="keywords" placeholder="Enter keywords">
            </div>

            <button type="submit" class="btn btn-primary w-100">Save Data</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@@yaireo/tagify"></script>

    @section Scripts {
        <script>
            // Activate Tagify
            var skillsInput = document.getElementById('skills');
            var keywordsInput = document.getElementById('keywords');

            var skillsTagify = new Tagify(skillsInput, { maxTags: 10 });
            var keywordsTagify = new Tagify(keywordsInput, { maxTags: 10 });

            //  Toast Display Function
            function showToast(message, type = 'danger') {
                var toastId = 'toast' + Date.now();

                var toastHtml = `
                    <div id="${toastId}" class="toast align-items-center text-white bg-${type} border-0 show mb-2" role="alert" aria-live="assertive" aria-atomic="true" style="min-width: 250px;">
                        <div class="d-flex">
                            <div class="toast-body">
                                ${message}
                            </div>
                            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                    </div>
                `;
                $('#toastContainer').append(toastHtml);

                setTimeout(function () {
                    $('#' + toastId).fadeOut(500, function () {
                        $(this).remove();
                    });
                }, 4000); // Auto-close after 4 seconds
            }

            //  Prevent adding more than 10 skills
            skillsTagify.on('input', function (e) {
                if (skillsTagify.value.length >= 10) {
                    skillsTagify.dropdown.hide();
                    showToast('You cannot add more than 10 skills.');
                    e.detail.input.value = '';
                }
            });

            //  Prevent adding more than 10 keywords
            keywordsTagify.on('input', function (e) {
                if (keywordsTagify.value.length >= 10) {
                    keywordsTagify.dropdown.hide();
                    showToast('You cannot add more than 10 keywords.');
                    e.detail.input.value = '';
                }
            });

            // Handle form submission
            $('#profileForm').on('submit', function (e) {
                e.preventDefault();

                var name = $('#name').val().trim();
                var biography = $('#biography').val().trim();
                var skills = skillsTagify.value;
                var keywords = keywordsTagify.value;

                if (!name) {
                    showToast('Please enter your name.');
                    return;
                }

                if (!biography) {
                    showToast('Please write your biography.');
                    return;
                }

                if (skills.length === 0) {
                    showToast('Please add at least one skill.');
                    return;
                }

                if (keywords.length === 0) {
                    showToast('Please add at least one keyword.');
                    return;
                }

                var submitButton = $(this).find('button[type="submit"]');
                submitButton.prop('disabled', true);
                submitButton.html(`<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> Sending...`);

                setTimeout(function () {
                    console.log({
                        name: name,
                        biography: biography,
                        skills: skills,
                        keywords: keywords
                    });

                    submitButton.prop('disabled', false);
                    submitButton.html('Save Data');

                    showToast('Data submitted successfully (check console).', 'success');
                }, 1500);
            });
        </script>
    }
</div>
