@using ProjetAtrst.ViewModels.Project
@model AvailableProjectsWithPaginationViewModel

<h2>المشاريع المتاحة للانضمام</h2>

<div id="projects-container" >
    @await Html.PartialAsync("_AvailableProjectsWithPaginationPartial", Model)
</div>

@section Scripts {
    <script>
        function loadPaginatedProjects(page) {
            showSpinner();

            $.ajax({
                url: '@Url.Action("AvailableProjects", "Project")',
                data: { page: page },
                success: function (result) {
                    $('#projects-container').html(result);  
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                },
                complete: function () {
                    hideSpinner();
                },
                error: function () {
                    alert('Erreur lors du chargement des projets.');
                }
            });
        }

        $(document).on('click', '.pagination-link', function (e) {
            e.preventDefault();
            var page = $(this).data('page');
            if (!$(this).parent().hasClass('disabled') && !$(this).parent().hasClass('active')) {
                loadPaginatedProjects(page);
            }
        });
    </script>
}
